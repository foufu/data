<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>自动定位城市</title>
	<script type="text/javascript">
		/*
			自动定位城市
				* http://ip.taobao.com/service/getIpInfo.php?ip=61.144.96.228

			城市 <- IP(外网) <- PHP爬数据（爬虫原理）

			编写php接口
		 */
		 let status = [200,304];
		 let xhr = new XMLHttpRequest();
		 xhr.onload = ()=>{
		 	if(status.indexOf(xhr.status) >=0){
		 		let ip = xhr.responseText;
		 		console.log(ip);

		 		// 根据ip地址获取城市
		 		xhr_city = new XMLHttpRequest();
		 		xhr_city.onload = ()=>{
		 			if(status.indexOf(xhr_city.status) != -1){
		 				console.log(xhr_city.responseText);
		 		
		 		}

		 		xhr_city.open('get','../api/auto_city.php?ip='+ip,true);
		 		xhr_city.send();
		 	}
		 }

	}
	  xhr.open('get','../api/outer_ip.php',true);
	  xhr.send();	
	</script>
</head>
<body>
	<h1>自动定位城市</h1>
</body>
</html>